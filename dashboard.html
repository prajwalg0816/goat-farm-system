<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üìä Goat Farm Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
/* ================= BASE ================= */
body{
  font-family:"Segoe UI",Arial;
  background:linear-gradient(135deg,#fdfbfb,#ebedee);
  margin:0;
  padding:16px;
  animation:pageFade .6s ease;
}
@keyframes pageFade{
  from{opacity:0;transform:translateY(8px)}
  to{opacity:1;transform:translateY(0)}
}
h2{
  color:#2c5364;
  display:flex;
  align-items:center;
  gap:10px;
}

/* Floating goat */
.goat-float{
  font-size:34px;
  animation:floatGoat 3s ease-in-out infinite;
}
@keyframes floatGoat{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-8px)}
}

/* ================= GRID ================= */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:16px;
}

/* ================= CARD ================= */
.card{
  background:#fff;
  border-radius:16px;
  padding:18px;
  box-shadow:0 8px 22px rgba(0,0,0,.08);
  text-align:center;
  transition:.3s;
}
.card:hover{
  transform:translateY(-4px);
  box-shadow:0 14px 32px rgba(0,0,0,.12);
}
.card h3{
  margin:0;
  font-size:14px;
  color:#555;
}
.card .num{
  font-size:30px;
  font-weight:bold;
  margin-top:6px;
}

/* ================= COLORS ================= */
.total{border-top:5px solid #2c5364}
.male{border-top:5px solid #3498db}
.female{border-top:5px solid #e84393}
.kid{border-top:5px solid #f1c40f}
.preg{border-top:5px solid #9b59b6}

.income{border-top:5px solid #1d976c}
.expense{border-top:5px solid #e84118}
.profit{border-top:5px solid #2c5364}

/* ================= MOBILE ================= */
@media(max-width:600px){
  h2{font-size:18px}
  .card .num{font-size:24px}
}
</style>
</head>

<body>

<h2>
  <span class="goat-float">üêê</span>
  Goat Farm Dashboard
</h2>

<div class="grid">

  <!-- GOATS -->
  <div class="card total">
    <h3>Total Goats</h3>
    <div class="num" id="total">0</div>
  </div>

  <div class="card male">
    <h3>Male Goats</h3>
    <div class="num" id="male">0</div>
  </div>

  <div class="card female">
    <h3>Female Goats</h3>
    <div class="num" id="female">0</div>
  </div>

  <div class="card kid">
    <h3>Kids</h3>
    <div class="num" id="kids">0</div>
  </div>

  <div class="card preg">
    <h3>Pregnant</h3>
    <div class="num" id="pregnant">0</div>
  </div>

  <!-- FINANCE -->
  <div class="card income">
    <h3>Total Income</h3>
    <div class="num" id="income">‚Çπ0</div>
  </div>

  <div class="card expense">
    <h3>Total Expense</h3>
    <div class="num" id="expense">‚Çπ0</div>
  </div>

  <div class="card profit">
    <h3>Net Profit</h3>
    <div class="num" id="profit">‚Çπ0</div>
  </div>

</div>

<script>
/* ================= SUPABASE ================= */
const db = supabase.createClient(
  "https://jrrorjoxlwqanebnchui.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impycm9yam94bHdxYW5lYm5jaHVpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg0NDk5ODMsImV4cCI6MjA4NDAyNTk4M30.KgITXQJmA9TNw6lbHW94egKOW_gW6nPK5UViDNC5l5k"
);

/* ================= LOAD DASHBOARD ================= */
async function loadDashboard(){

  /* ---- GOATS ---- */
  const { data: goats } = await db.from("goats").select("*");

  let male=0, female=0, kids=0, pregnant=0;
  goats.forEach(g=>{
    if(g.gender==="Male") male++;
    if(g.gender==="Female") female++;
    if(g.life_status==="Kid") kids++;
    if(g.life_status==="Pregnant") pregnant++;
  });

  document.getElementById("total").innerText = goats.length;
  document.getElementById("male").innerText = male;
  document.getElementById("female").innerText = female;
  document.getElementById("kids").innerText = kids;
  document.getElementById("pregnant").innerText = pregnant;

  /* ---- FINANCE ---- */
  const { data: finance } = await db.from("finance").select("*");

  let inc=0, exp=0;
  finance.forEach(f=>{
    if(f.type==="Income") inc+=Number(f.amount);
    if(f.type==="Expense") exp+=Number(f.amount);
  });

  document.getElementById("income").innerText = "‚Çπ"+inc;
  document.getElementById("expense").innerText = "‚Çπ"+exp;
  document.getElementById("profit").innerText = "‚Çπ"+(inc-exp);
}

/* INIT */
loadDashboard();
</script>

</body>
</html>
